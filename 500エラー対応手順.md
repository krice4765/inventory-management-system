# 500 Internal Server Error 対応手順

## 🚨 現在の状況
- SMTP設定は完了済み
- パスワードリセット時に500エラーが発生
- "Error sending recovery email"

## 🔧 対応手順

### Step 1: Sender Email設定の確認・修正
```
現在: noreply@gmail.com
問題: このアドレスが実際に存在しない可能性

修正案:
- SMTP Username と同じGmailアドレスを使用
- 例: Access__仕入れ管理@gmail.com
```

### Step 2: Gmail SMTP認証の再確認
```
確認項目:
1. Gmailアカウントの2段階認証が有効か
2. アプリパスワードが正しく生成されているか
3. SMTP Username が正確か
4. アプリパスワードが期限切れでないか
```

### Step 3: Supabase SMTP設定の再設定
```
1. Supabase Dashboard → Authentication → Emails → SMTP Settings
2. Sender email を SMTP Username と同じアドレスに変更
3. 必要に応じてSMTP認証情報を再入力
4. 設定を保存
```

### Step 4: Gmail アカウント設定確認
```
Google アカウント設定で確認:
1. セキュリティ → 2段階認証プロセス → 有効確認
2. アプリパスワード → 新しいパスワード生成
3. 「安全性の低いアプリ」設定 → 無効にする（アプリパスワード使用）
```

### Step 5: 代替SMTP設定（必要に応じて）
```
Gmail で問題が続く場合:
- SendGrid無料プランを検討
- または他のトランザクショナルメールサービス

SendGrid設定例:
Host: smtp.sendgrid.net
Port: 587
User: apikey
Pass: [SendGrid API Key]
Sender: 実際のメールアドレス
```

## 🧪 テスト手順
1. 設定変更後、5分程度待機
2. パスワードリセット機能を再テスト
3. ブラウザのNetwork タブでAPI レスポンスを確認
4. 500エラーが解消されることを確認

## 📊 期待される結果
- 500エラーの解消
- パスワードリセットメールの正常送信
- ユーザーへの適切なフィードバック表示

---
**緊急度**: HIGH
**所要時間**: 10-15分